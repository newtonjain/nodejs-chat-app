'use strict';

import { IAgent } from '../IAgent';
import { IAgentBroker } from './IAgentBroker';
import { MessageConverter } from './MessageConverter';

export class AgentBroker implements IAgentBroker {

    public constructor(private agent: IAgent) {
    }

    public sendMessage(data, types, indices, context) {
        if (!context) {
            context = this.agent.providers.contextManager.currentContext();
        }

        if (context) {
            const message = MessageConverter.convertMessage(data, types, indices, context);

            this.agent.providers.messagePublisher.publishMessages([message]);
        }
    }
}
