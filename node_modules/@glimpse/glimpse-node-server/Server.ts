'use strict';

import { IServer } from './IServer';

import { MessagePublisher } from './messaging/MessagePublisher';
import { InMemoryMessageQuery } from './storage/InMemoryMessageQuery';
import { InMemoryMessageStorage } from './storage/InMemoryMessageStorage';
import { ResourceManager } from './resources/ResourceManager';

export class Server implements IServer {
    private _messageStorage = new InMemoryMessageStorage();
    private _messagePublisher = new MessagePublisher(this._messageStorage);
    private _messageQuery = new InMemoryMessageQuery(this._messageStorage);
    private _resourceManager = new ResourceManager();

    public providers = {
        messagePublisher: this._messagePublisher,
        messageQuery: this._messageQuery,
        resourceManager: this._resourceManager,

        // TODO: Set this properly once the resource provider has been converted to TypeScript.
        resourceProvider: undefined
    };
}

export var instance = new Server();
