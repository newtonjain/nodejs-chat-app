'use strict';

import { IResource } from './IResource';
import { IResourceManager } from './IResourceManager';
import { IServer } from '../IServer';

export class Resource implements IResource {
    private resourceManager: IResourceManager;

    constructor(server: IServer) {
        this.resourceManager = server.providers.resourceManager;
    }

    public name = 'export-config';
    public uriTemplate = '?hash={hash}';
    public type = 'client';
    public invoke(req, res) {
        const baseUri = req.protocol + '://' + req.get('host') + '/glimpse';
        const resources = this.resourceManager.getUriTemplates(baseUri);

        res.setHeader('Content-Disposition', 'attachment; filename = glimpse.json');
        res.json(resources);
    };
}
